{"version":3,"file":"connection.js","sourceRoot":"","sources":["../../src/db/connection.ts"],"names":[],"mappings":";;;;;;AAAA,2BAA0B;AAC1B,oDAA4B;AAE5B,gBAAM,CAAC,MAAM,EAAE,CAAC;AAahB,MAAM,UAAU,GAAe;IAC7B,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,WAAW;IACxC,IAAI,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,MAAM,CAAC;IAC7C,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,OAAO;IACpC,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,WAAW,IAAI,UAAU;IAC/C,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,eAAe;IAChD,GAAG,EAAE,EAAE;IACP,iBAAiB,EAAE,KAAK;IACxB,uBAAuB,EAAE,IAAI;CAC9B,CAAC;AAEF,MAAM,IAAI,GAAG,IAAI,SAAI,CAAC,UAAU,CAAC,CAAC;AA+BlB,oBAAI;AA5BpB,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,GAAG,EAAE;IACtB,OAAO,CAAC,GAAG,CAAC,wCAAwC,CAAC,CAAC;AACxD,CAAC,CAAC,CAAC;AAEH,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,CAAC,GAAU,EAAE,EAAE;IAC9B,OAAO,CAAC,KAAK,CAAC,8BAA8B,EAAE,GAAG,CAAC,CAAC;AACrD,CAAC,CAAC,CAAC;AAGH,MAAM,KAAK,GAAG,KAAK,EACjB,IAAY,EACZ,MAAc,EAC4B,EAAE;IAC5C,MAAM,KAAK,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;IACzB,IAAI,CAAC;QACH,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QAC3C,MAAM,QAAQ,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC;QACpC,OAAO,CAAC,GAAG,CAAC,sBAAsB,QAAQ,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QAC1G,OAAO;YACL,IAAI,EAAE,GAAG,CAAC,IAAW;YACrB,QAAQ,EAAE,GAAG,CAAC,QAAQ,IAAI,CAAC;SAC5B,CAAC;IACJ,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,CAAC,KAAK,CAAC,kBAAkB,IAAI,EAAE,EAAE,KAAK,CAAC,CAAC;QAC/C,MAAM,KAAK,CAAC;IACd,CAAC;AACH,CAAC,CAAC;AAEO,sBAAK;AACd,kBAAe,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC","sourcesContent":["import { Pool } from 'pg';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\ninterface PoolConfig {\n  host: string;\n  port: number;\n  user: string;\n  password: string;\n  database: string;\n  max?: number;\n  idleTimeoutMillis?: number;\n  connectionTimeoutMillis?: number;\n}\n\nconst poolConfig: PoolConfig = {\n  host: process.env.DB_HOST || 'localhost',\n  port: parseInt(process.env.DB_PORT || '5433'),\n  user: process.env.DB_USER || 'admin',\n  password: process.env.DB_PASSWORD || 'admin123',\n  database: process.env.DB_NAME || 'zyx_logistics',\n  max: 20,\n  idleTimeoutMillis: 30000,\n  connectionTimeoutMillis: 2000,\n};\n\nconst pool = new Pool(poolConfig);\n\n// Event listeners\npool.on('connect', () => {\n  console.log('Conectado ao banco de dados PostgreSQL');\n});\n\npool.on('error', (err: Error) => {\n  console.error('Erro na conex√£o com o banco:', err);\n});\n\n// Query wrapper com tipos\nconst query = async <T = any>(\n  text: string,\n  params?: any[]\n): Promise<{ rows: T[]; rowCount: number }> => {\n  const start = Date.now();\n  try {\n    const res = await pool.query(text, params);\n    const duration = Date.now() - start;\n    console.log(`Query executada em ${duration}ms: ${text.substring(0, 50)}${text.length > 50 ? '...' : ''}`);\n    return {\n      rows: res.rows as T[],\n      rowCount: res.rowCount || 0\n    };\n  } catch (error) {\n    console.error(`Erro na query: ${text}`, error);\n    throw error;\n  }\n};\n\nexport { query, pool };\nexport default { query, pool };\n"]}